* Accounts
** DONE day <2018-07-01 Dim>
   :PROPERTIES:
   :total:    305
   :END:
   
   | sum | 305 |
   #+TBLFM: $2=remote(expenses<2018-07-01 Dim>,@2$2)

   #+NAME: expenses<2018-07-01 Dim>   
   |-------------+-------+----------------|
   | item        | price | note           |
   |-------------+-------+----------------|
   | total       |   305 |                |
   |-------------+-------+----------------|
   | beverage I  |    55 | dan kiang      |
   |-------------+-------+----------------|
   | lunch       |   110 | unknown        |
   |-------------+-------+----------------|
   | beverage II |    55 | miti bank      |
   |-------------+-------+----------------|
   | dinnner     |    85 | taiwan vietnan |
   |-------------+-------+----------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-02 Lun>
   :PROPERTIES:
   :total:    210
   :END:
   
   | sum | 210 |
   #+TBLFM: $2=remote(expenses<2018-07-02 Lun>,@2$2)

   #+NAME: expenses<2018-07-02 Lun>   
   |-----------+-------+---------|
   | item      | price | note    |
   |-----------+-------+---------|
   | total     |   210 |         |
   |-----------+-------+---------|
   | breakfast |    45 | xiao fu |
   |-----------+-------+---------|
   | lunch     |    55 | Xan Lin |
   |-----------+-------+---------|
   | dinner    |   110 | Mon Na  |
   |-----------+-------+---------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-03 Mar>
   :PROPERTIES:
   :total:    219
   :END:
   
   | sum | 219 |
   #+TBLFM: $2=remote(expenses<2018-07-03 Mar>,@2$2)

   #+NAME: expenses<2018-07-03 Mar>   
   |----------+-------+-------------------|
   | item     | price | note              |
   |----------+-------+-------------------|
   | total    |   219 |                   |
   |----------+-------+-------------------|
   | lunch    |    55 | xiao fu           |
   |----------+-------+-------------------|
   | coffee   |    24 | automatic vending |
   |          |       | machine           |
   |----------+-------+-------------------|
   | dinner   |    95 | big pot           |
   |----------+-------+-------------------|
   | beverage |    45 | Spring Fang       |
   |----------+-------+-------------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-04 Mer>
   :PROPERTIES:
   :total:    375
   :END:
   
   | sum | 375 |
   #+TBLFM: $2=remote(expenses<2018-07-04 Mer>,@2$2)

   #+NAME: expenses<2018-07-04 Mer>   
   |----------+-------+------------------|
   | item     | price | note             |
   |----------+-------+------------------|
   | total    |   375 |                  |
   |----------+-------+------------------|
   | lunch    |   230 | So Ho            |
   |----------+-------+------------------|
   | beverage |    35 | thick milk tea   |
   |          |       | Soul ba          |
   |----------+-------+------------------|
   | dinner   |   110 | Big Lee Dumpling |
   |----------+-------+------------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-05 Jeu>
   :PROPERTIES:
   :total:    329
   :END:
   
   | sum | 329 |
   #+TBLFM: $2=remote(expenses<2018-07-05 Jeu>,@2$2)

   #+NAME: expenses<2018-07-05 Jeu>   
   |-----------+-------+----------------|
   | item      | price | note           |
   |-----------+-------+----------------|
   | total     |   329 |                |
   |-----------+-------+----------------|
   | breakfast |    45 | xiao fu        |
   |-----------+-------+----------------|
   | lunch     |    50 | spicy noodle   |
   |-----------+-------+----------------|
   | beverage  |    45 | royal milk tea |
   |-----------+-------+----------------|
   | dinner    |   149 | Tsai Wuei      |
   |-----------+-------+----------------|
   | beverage  |    40 | empty cup :-(  |
   |-----------+-------+----------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-06 Ven>
   :PROPERTIES:
   :total:    481
   :END:
   
   | sum | 481 |
   #+TBLFM: $2=remote(expenses<2018-07-06 Ven>,@2$2)

   #+NAME: expenses<2018-07-06 Ven>   
   |-----------+-------+---------------------|
   | item      | price | note                |
   |-----------+-------+---------------------|
   | total     |   481 |                     |
   |-----------+-------+---------------------|
   | breakfast |    45 | xiao fu             |
   |-----------+-------+---------------------|
   | lunch     |    85 | xiao fu             |
   |-----------+-------+---------------------|
   | dinner    |   300 | one lamp            |
   |-----------+-------+---------------------|
   | beverage  |    51 | fifty mountain wind |
   |-----------+-------+---------------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-07 Sam>
   :PROPERTIES:
   :total:    209
   :END:
   
   | sum | 209 |
   #+TBLFM: $2=remote(expenses<2018-07-07 Sam>,@2$2)

   #+NAME: expenses<2018-07-07 Sam>   
   |----------+-------+----------------|
   | item     | price | note           |
   |----------+-------+----------------|
   | total    |   209 |                |
   |----------+-------+----------------|
   | lunch    |    84 | 7-11           |
   |----------+-------+----------------|
   | dinner   |    85 | taiwan vietnan |
   |----------+-------+----------------|
   | beverage |    40 | Family Mart    |
   |----------+-------+----------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-08 Dim>
   :PROPERTIES:
   :total:    219
   :END:
   
   | sum | 219 |
   #+TBLFM: $2=remote(expenses<2018-07-08 Dim>,@2$2)

   #+NAME: expenses<2018-07-08 Dim>   
   |--------+-------+-------------------|
   | item   | price | note              |
   |--------+-------+-------------------|
   | total  |   219 |                   |
   |--------+-------+-------------------|
   | lunch  |    85 | three sees        |
   |--------+-------+-------------------|
   | coffee |    24 | automatic vending |
   |        |       | machine           |
   |--------+-------+-------------------|
   | dinner |   110 | big pot           |
   |--------+-------+-------------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-09 Lun>
   :PROPERTIES:
   :total:    254
   :END:
   
   | sum | 254 |
   #+TBLFM: $2=remote(expenses<2018-07-09 Lun>,@2$2)

   #+NAME: expenses<2018-07-09 Lun>   
   |-----------+-------+-------------|
   | item      | price | note        |
   |-----------+-------+-------------|
   | total     |   254 |             |
   |-----------+-------+-------------|
   | breakfast |    30 | Xiao Fu     |
   |-----------+-------+-------------|
   | lunch     |    69 | Xiao Fu     |
   |-----------+-------+-------------|
   | dinner    |   105 | Chen        |
   |-----------+-------+-------------|
   | beverage  |    50 | Spring fang |
   |-----------+-------+-------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-10 Mar>
   :PROPERTIES:
   :total:    175
   :END:
   
   | sum | 175 |
   #+TBLFM: $2=remote(expenses<2018-07-10 Mar>,@2$2)

   #+NAME: expenses<2018-07-10 Mar>   
   |-----------+-------+-----------------------|
   | item      | price | note                  |
   |-----------+-------+-----------------------|
   | total     |   175 |                       |
   |-----------+-------+-----------------------|
   | breakfast |    55 | chicken leg and toast |
   |           |       | Xiao Fu               |
   |-----------+-------+-----------------------|
   | lunch     |    65 | noodle Chen           |
   |-----------+-------+-----------------------|
   | beverage  |    55 | spring fang           |
   |-----------+-------+-----------------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-11 Mer>
   :PROPERTIES:
   :total:    230
   :END:
   
   | sum | 230 |
   #+TBLFM: $2=remote(expenses<2018-07-11 Mer>,@2$2)

   #+NAME: expenses<2018-07-11 Mer>   
   |----------+-------+-----------------|
   | item     | price | note            |
   |----------+-------+-----------------|
   | total    |   230 |                 |
   |----------+-------+-----------------|
   | lunch    |    60 | four directions |
   |----------+-------+-----------------|
   | beverage |    65 | Mitty Bank      |
   |----------+-------+-----------------|
   | dinner   |   105 | big pot         |
   |----------+-------+-----------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-12 Jeu>
   :PROPERTIES:
   :total:    220
   :END:
   
   | sum | 220 |
   #+TBLFM: $2=remote(expenses<2018-07-12 Jeu>,@2$2)

   #+NAME: expenses<2018-07-12 Jeu>   
   |----------+-------+-----------------|
   | item     | price | note            |
   |----------+-------+-----------------|
   | total    |   220 |                 |
   |----------+-------+-----------------|
   | lunch    |    95 | four directions |
   |----------+-------+-----------------|
   | beverage |    35 | 7-11            |
   |----------+-------+-----------------|
   | dinner   |    90 | MAJI            |
   |----------+-------+-----------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-13 Ven>
   :PROPERTIES:
   :total:    340
   :END:
   
   | sum | 340 |
   #+TBLFM: $2=remote(expenses<2018-07-13 Ven>,@2$2)

   #+NAME: expenses<2018-07-13 Ven>   
   |----------+-------+-----------|
   | item     | price | note      |
   |----------+-------+-----------|
   | total    |   340 |           |
   |----------+-------+-----------|
   | lunch    |    80 | Xiao Fu   |
   |----------+-------+-----------|
   | beverage |    60 | Miss. Kuo |
   |----------+-------+-----------|
   | dinner   |   200 | Barker    |
   |----------+-------+-----------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-14 Sam>
   :PROPERTIES:
   :total:    224
   :END:
   
   | sum | 224 |
   #+TBLFM: $2=remote(expenses<2018-07-14 Sam>,@2$2)

   #+NAME: expenses<2018-07-14 Sam>   
   |----------+-------+-----------------|
   | item     | price | note            |
   |----------+-------+-----------------|
   | total    |   224 |                 |
   |----------+-------+-----------------|
   | lunch    |    65 | four directions |
   |----------+-------+-----------------|
   | beverage |    39 | 7-11            |
   |----------+-------+-----------------|
   | dinner   |    85 | big pot         |
   |----------+-------+-----------------|
   | snack    |    35 | chocolate cake  |
   |----------+-------+-----------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)

** DONE day <2018-07-15 Dim>                                        :account:
   :PROPERTIES:
   :total:    101
   :END:
   
   | sum | 101 |
   #+TBLFM: $2=remote(expenses<2018-07-15 Dim>,@2$2)

   #+NAME: expenses<2018-07-15 Dim>   
   |-------+-------+----------------------|
   | item  | price | note                 |
   |-------+-------+----------------------|
   | total |   101 |                      |
   | lunch |   101 | family mart and 7-11 |
   |-------+-------+----------------------|
   #+TBLFM: @2$2=vsum(@3$2..@>$2)


* Summary
  The total cost for this month:
  #+BEGIN_SRC emacs-lisp :exports results
    (defun org-get-account-all ()
      (tabularize (mapcar '(lambda (x) (if (null x) 0 (string-to-number x)))
			  (org-map-entries (lambda ()
					     (org-entry-get nil "TOTAL"))))))

    (defun tabularize (a_list)
      "summarize and tabularize"
      (let ((count 1)
	    (week '((1 0)))
	    (week_count 1))
	(dolist (elem a_list week)
	  (setq count (+ 1 count))
	  (if (= (% count 7) 0)
	      (progn
		(setq week_count (+ 1 week_count))
		(add-to-list 'week `(,week_count 0))))
	  (setf (cdr (assoc week_count week)) (list (+ (cadr (assoc week_count week)) elem))))))

    (setq total-list (org-get-account-all))

    (add-to-list 'total-list `("all" ,(apply '+ (mapcar 'cadr total-list))))
  #+END_SRC

  #+RESULTS:
  | all | 3891 |
  |   3 |  885 |
  |   2 | 1897 |
  |   1 | 1109 |
